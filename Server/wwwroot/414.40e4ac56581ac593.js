"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[414],{2414:(et,f,i)=>{i.r(f),i.d(f,{AdminModule:()=>V});var m=i(9808),p=i(9291),t=i(5e3),h=i(1793),T=i(6059),d=i(3075),g=i(3892),u=i(4847),r=i(4999),M=i(2340),R=i(520);let v=(()=>{class e{constructor(n){this.http=n,this.baseUrl=M.N.apiUrl}getUsersWithRoles(){return this.http.get(this.baseUrl+"admin/users-with-roles")}updateUserRoles(n,a){return this.http.post(this.baseUrl+"admin/edit-roles/"+n+"?roles="+a,{})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(R.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=i(7261),C=i(1134),U=i(7423);function b(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",10)(1,"input",11),t.NdJ("change",function(){const l=t.CHM(n).$implicit;return l.checked=!l.checked}),t.qZA(),t.TgZ(2,"label"),t._uU(3),t.qZA()()}if(2&e){const n=o.$implicit,a=t.oxw();t.xp6(1),t.Q6J("checked",n.checked)("disabled","Admin"===n.name&&"admin"===a.user.username),t.xp6(2),t.Oqu(n.name)}}function x(e,o){1&e&&t._UZ(0,"i",12)}let y=(()=>{class e{constructor(n,a,s){this.adminService=n,this.snackBar=a,this.bsModalRef=s,this.updateSelectedRoles=new t.vpe,this.loading=!1}ngOnInit(){}updateRoles(){this.loading=!0,this.updateSelectedRoles.emit(this.roles),this.bsModalRef.hide(),this.loading=!1}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v),t.Y36(_.ux),t.Y36(C.UZ))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-edit-roles"]],inputs:{updateSelectedRoles:"updateSelectedRoles"},decls:14,vars:6,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body"],["id","rolesForm"],["rolesForm","ngForm"],["class","form-check",4,"ngFor","ngForOf"],[1,"modal-footer",3,"align"],["mat-raised-button","","color","warn",1,"mr-5",3,"click"],["mat-raised-button","","color","primary",1,"ml-3",3,"click"],["class","fa fa-spinner fa-spin",4,"ngIf"],[1,"form-check"],["type","checkbox","value","role.name",1,"form-check-input",3,"checked","disabled","change"],[1,"fa","fa-spinner","fa-spin"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2),t.ALo(3,"titlecase"),t.qZA()(),t.TgZ(4,"div",2)(5,"form",3,4),t.YNc(7,b,4,3,"div",5),t.qZA()(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return a.bsModalRef.hide()}),t._uU(10,"Close"),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return a.updateRoles()}),t._uU(12," Update "),t.YNc(13,x,1,0,"i",9),t.qZA()()),2&n&&(t.xp6(2),t.hij("Edit roles for ",t.lcZ(3,4,a.user.username),""),t.xp6(5),t.Q6J("ngForOf",a.roles),t.xp6(1),t.Q6J("align","end"),t.xp6(5),t.Q6J("ngIf",a.loading))},directives:[d._Y,d.JL,d.F,m.sg,U.lW,m.O5],pipes:[m.rS],styles:[""]}),e})();var A=i(7322),S=i(7531),N=i(5245),w=i(7238);function k(e,o){1&e&&(t.TgZ(0,"th",21),t._uU(1," Photo "),t.qZA())}function Y(e,o){if(1&e&&(t.TgZ(0,"td",22),t._UZ(1,"img",23),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.s9C("src",n.photoUrl||"assets/user.png",t.LSH),t.s9C("alt",n.firstName)}}function F(e,o){1&e&&(t.TgZ(0,"th",21),t._uU(1," Username "),t.qZA())}function D(e,o){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.username," ")}}function J(e,o){1&e&&(t.TgZ(0,"th",21),t._uU(1," Active Roles "),t.qZA())}function O(e,o){if(1&e&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.roles," ")}}function E(e,o){1&e&&t._UZ(0,"th",24)}function Q(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"td",22)(1,"button",25),t.NdJ("click",function(){const l=t.CHM(n).$implicit;return t.oxw().openRolesModal(l)}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()()}if(2&e){const n=t.oxw();t.xp6(1),t.Q6J("matTooltipPosition",n.position.value)}}function P(e,o){1&e&&t._UZ(0,"tr",26)}function H(e,o){1&e&&t._UZ(0,"tr",27)}function B(e,o){if(1&e&&(t.TgZ(0,"tr",28)(1,"td",29),t._uU(2),t.qZA()()),2&e){t.oxw();const n=t.MAs(6);t.xp6(2),t.hij('No data matching the filter "',n.value,'"')}}const z=function(){return[5,10,25,100]};let G=(()=>{class e{constructor(n,a){this.adminService=n,this.modalService=a,this.displayedColumns=["photoUrl","username","roles","action"],this.positionOptions=["below"],this.position=new d.NI(this.positionOptions[0])}ngOnInit(){this.loadUsersWithRoles()}loadUsersWithRoles(){this.adminService.getUsersWithRoles().subscribe(n=>{this.dataSource=new r.by(n),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(n){this.dataSource.filter=n.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}openDialog(){}openRolesModal(n){const a={ignoreBackdropClick:!0,class:"modal-dialog-centered",initialState:{user:n,roles:this.getRolesArray(n)}};this.bsModalRef=this.modalService.show(y,a),this.bsModalRef.content.updateSelectedRoles.subscribe(s=>{const l={roles:[...s.filter(c=>!0===c.checked).map(c=>c.name)]};l&&this.adminService.updateUserRoles(n.username,l.roles).subscribe(()=>{n.roles=[...l.roles]})})}deleteDialog(n){}getRolesArray(n){const a=[],s=n.roles;return[{name:"Admin",value:"Admin"},{name:"Moderator",value:"Moderator"},{name:"Guard",value:"Guard"}].forEach(c=>{let Z=!1;for(const tt of s)if(c.name===tt){Z=!0,c.checked=!0,a.push(c);break}Z||(c.checked=!1,a.push(c))}),a}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v),t.Y36(C.tT))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-user-management"]],viewQuery:function(n,a){if(1&n&&(t.Gf(g.NW,5),t.Gf(u.YE,5)),2&n){let s;t.iGM(s=t.CRH())&&(a.paginator=s.first),t.iGM(s=t.CRH())&&(a.sort=s.first)}},decls:31,vars:5,consts:[[1,"d-flex"],[1,"d-flex","col-4"],["appearance","standard"],["matInput","","placeholder","Search Prisoner...",3,"keyup"],["input",""],[1,"p-4",2,"margin-left","40%"],["routerLink","/dashboard","mat-raised-button","","color","default"],[1,"col-12"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","photoUrl"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","roles"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"src","alt"],["mat-header-cell",""],["mat-icon-button","","color","accent","matTooltip","Edit data",3,"matTooltipPosition","click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),t._uU(4,"Filter"),t.qZA(),t.TgZ(5,"input",3,4),t.NdJ("keyup",function(l){return a.applyFilter(l)}),t.qZA()()(),t.TgZ(7,"div",5)(8,"button",6)(9,"mat-icon"),t._uU(10,"add"),t.qZA(),t._uU(11," Go back "),t.qZA()()(),t.TgZ(12,"div",7)(13,"div",8)(14,"table",9),t.ynx(15,10),t.YNc(16,k,2,0,"th",11),t.YNc(17,Y,2,2,"td",12),t.BQk(),t.ynx(18,13),t.YNc(19,F,2,0,"th",11),t.YNc(20,D,2,1,"td",12),t.BQk(),t.ynx(21,14),t.YNc(22,J,2,0,"th",11),t.YNc(23,O,2,1,"td",12),t.BQk(),t.ynx(24,15),t.YNc(25,E,1,0,"th",16),t.YNc(26,Q,4,1,"td",12),t.BQk(),t.YNc(27,P,1,0,"tr",17),t.YNc(28,H,1,0,"tr",18),t.YNc(29,B,3,1,"tr",19),t.qZA(),t._UZ(30,"mat-paginator",20),t.qZA()()),2&n&&(t.xp6(14),t.Q6J("dataSource",a.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(4,z)))},directives:[A.KE,A.hX,S.Nt,U.lW,p.rH,N.Hw,r.BZ,u.YE,r.w1,r.fO,r.ge,u.nU,r.Dz,r.ev,w.gM,r.as,r.XQ,r.nj,r.Gk,r.Ee,g.NW],styles:["table[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:12%}tr[_ngcontent-%COMP%]:hover{background:#e3e3e3}img[_ngcontent-%COMP%]{border-radius:50%;width:25%}"]}),e})();function I(e,o){1&e&&(t.TgZ(0,"tab",6)(1,"div",7),t._UZ(2,"app-user-management"),t.qZA()())}function W(e,o){1&e&&(t.TgZ(0,"tab",8)(1,"div",7),t._uU(2," Feed back approval will go here "),t.qZA()())}const j=function(){return["Admin"]},q=function(){return["Admin","Moderator"]};let L=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-admin-panel"]],decls:7,vars:4,consts:[[1,""],[1,"text-center",2,"font-family","serif"],[1,"tab-panel"],[1,"member-tabset"],["heading","User management",4,"appHasRole"],["heading","Feedback management",4,"appHasRole"],["heading","User management"],[1,"container"],["heading","Feedback management"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Administrator"),t.qZA(),t.TgZ(3,"div",2)(4,"tabset",3),t.YNc(5,I,3,0,"tab",4),t.YNc(6,W,3,0,"tab",5),t.qZA()()()),2&n&&(t.xp6(5),t.Q6J("appHasRole",t.DdM(2,j)),t.xp6(1),t.Q6J("appHasRole",t.DdM(3,q)))},directives:[h.AH,T.c,h.wW,G],styles:[""]}),e})();const X=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-admin"]],decls:3,vars:0,consts:[[1,"container","p-3","mt-5"],[1,"row"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"app-admin-panel"),t.qZA()())},directives:[L],styles:[""]}),e})()}];let $=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[p.Bz.forChild(X)],p.Bz]}),e})();var K=i(7928);let V=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[m.ez,$,K.m]]}),e})()}}]);